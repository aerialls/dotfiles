#!/bin/sh

SCRIPT=$0:A
DOTFILES="$(cd "$(dirname $SCRIPT)/.." && pwd)"
HOSTNAME="$(hostname -s)"

HOMEBREW_PACKAGES=(
    'curl'
    'git'
    'git-town'
    'go'
    'ncdu'
    'openssl'
    'telnet'
)

source $DOTFILES/zsh/functions.zsh

cd $DOTFILES && git submodule init && git submodule update

# Fonts
$DOTFILES/fonts/install.sh &> /dev/null

# Visual Studio Code
ln -nfs $DOTFILES/vscode/settings.json ~/Library/Application\ Support/Code/User/settings.json

# Git
ln -nfs $DOTFILES/git/gitconfig ~/.gitconfig
ln -nfs $DOTFILES/git/gitignore-global ~/.gitignore-global

if [ -f "$DOTFILES/git/gitconfig-$HOSTNAME" ]; then
    ln -nfs $DOTFILES/git/gitconfig-$HOSTNAME ~/.gitconfig-local
fi

# ZSH
ln -nfs $DOTFILES/zsh/zshrc.zsh ~/.zshrc

# macOS specific stuff
if is_macos; then
    # Homebrew
    for package in "${HOMEBREW_PACKAGES[@]}"; do
        brew install $package &> /dev/null
    done

    # iTerm
    defaults write com.googlecode.iterm2 "PrefsCustomFolder" -string "$DOTFILES/iterm"
    defaults write com.googlecode.iterm2 "LoadPrefsFromCustomFolder" -bool true
fi
