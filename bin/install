#!/bin/sh

SCRIPT=$0:A
DOTFILES="$(cd "$(dirname $SCRIPT)/.." && pwd)"
HOSTNAME="$(hostname -s)"

source $DOTFILES/zsh/functions.zsh

cd $DOTFILES && git submodule init && git submodule update

# Fonts
$DOTFILES/fonts/install.sh &> /dev/null

# homebrew
if is_macos; then
    packages=(
        'curl'
        'git'
        'git-town'
        'go'
        'ncdu'
        'openssl'
        'telnet'
    )

    for package in "${packages[@]}"; do
        brew install $package &> /dev/null
    done
fi

# Visual Studio Code
ln -nfs $DOTFILES/vscode/settings.json ~/Library/Application\ Support/Code/User/settings.json

# Git
ln -nfs $DOTFILES/git/gitconfig ~/.gitconfig
ln -nfs $DOTFILES/git/gitignore-global ~/.gitignore-global

if [ -f "$DOTFILES/git/gitconfig-$HOSTNAME" ]; then
    ln -nfs $DOTFILES/git/gitconfig-$HOSTNAME ~/.gitconfig-local
fi

# ZSH
ln -nfs $DOTFILES/zsh/zshrc.zsh ~/.zshrc

# iTerm
if is_macos; then
    defaults write com.googlecode.iterm2 "PrefsCustomFolder" -string "$DOTFILES/iterm"
    defaults write com.googlecode.iterm2 "LoadPrefsFromCustomFolder" -bool true
fi
